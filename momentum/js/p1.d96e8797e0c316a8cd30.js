(()=>{"use strict";const e=document.querySelector(".time"),t=document.querySelector(".date"),n=document.querySelector(".greeting"),o=document.querySelector(".name"),a={en:"en-US",ru:"ru-RU"};let c;function r(o="en"){let s=o;const i=new Date,u=i.toLocaleTimeString("en-US",{hour12:!1,hour:"numeric",minute:"numeric",second:"numeric"});e.textContent=u,function(e,n="en"){const o=e.toLocaleDateString(`${a[n]}`,{weekday:"long",month:"long",day:"numeric"});t.textContent=o}(i,s);const l=function(e,t="en"){const n=e.getHours();let o=Math.floor(n/6);if("ru"==t)switch(o){case 0:return"ночи";case 1:return"утро";case 2:return"день";case 3:return"вечер"}else switch(o){case 0:return"night";case 1:return"morning";case 2:return"afternoon";case 3:return"evening"}}(i,s);n.textContent="ru"===s?"день"===l||"вечер"===l?`Добрый ${l},`:"утро"===l?`Доброе ${l},`:`Доброй ${l},`:`Good ${l[0].toUpperCase()+l.slice(1)},`,c=setTimeout((()=>{r(s)}),1e3)}function s(){localStorage.setItem("name",o.value)}r(),o.addEventListener("change",s),window.addEventListener("DOMContentLoaded",(function(){localStorage.getItem("name")&&(o.value=localStorage.getItem("name"))})),window.addEventListener("beforeunload",s);const i=document.querySelector(".weather-icon"),u=document.querySelector(".temperature"),l=document.querySelector(".weather-description"),d=document.querySelector(".weather-error"),m=document.querySelector(".city"),g=document.querySelector(".wind"),f=document.querySelector(".humidity");function h(e){return Math.round(e)}async function y(e="en"){const t=`https://api.openweathermap.org/data/2.5/weather?q=${m.value}&lang=${e}&appid=9f3de14e252fbf325b5d4bcb3413e236&units=metric`;try{const n=await fetch(t),o=await n.json();i.classList.add(`owf-${o.weather[0].id}`),u.textContent=`${h(o.main.temp)}°C`,l.textContent=o.weather[0].description,"ru"===e?(g.textContent=`Скорость ветра: ${h(o.wind.speed)} м/с`,f.textContent=`Влажность: ${h(o.main.humidity)} %`):(g.textContent=`Wind speed: ${h(o.wind.speed)} m/s`,f.textContent=`Humidity: ${h(o.main.humidity)} %`),d.textContent=""}catch(t){i.className="weather-icon owf",u.textContent="---- °C",l.textContent="","ru"===e?(d.textContent=`Ошибка! Город ${m.value} не найден!`,g.textContent="Скорость ветра: ---- м/с",f.textContent="Влажность: ---- %"):(d.textContent=`Error! city not found for ${m.value}!`,g.textContent="Wind speed: ---- m/s",f.textContent="Humidity: ---- %")}}y(),document.addEventListener("DOMContentLoaded",y),m.addEventListener("keypress",(function(e){"Enter"===e.code&&(y(),m.blur())}));const v=document.querySelector(".quote"),p=document.querySelector(".author"),_=document.querySelector(".change-quote");let L=w();async function S(e="en"){const t=`./json/data-${e}.json`,n=await fetch(t),o=await n.json();v.textContent=o[L].text,p.textContent=o[L].author}function w(){return Math.floor(10*Math.random())}function E(){localStorage.setItem("city",m.value)}S(),_.addEventListener("click",(()=>{let e=L;for(L=w();e===L;)L=w();S()})),m.addEventListener("change",E),window.addEventListener("DOMContentLoaded",(function(){localStorage.getItem("city")&&(m.value=localStorage.getItem("city"))})),window.addEventListener("beforeunload",E);const q=[{title:"Aqua Caelestis",src:"./assets/sounds/Aqua_Caelestis.mp3",duration:"00:58"},{title:"River Flows In You",src:"./assets/sounds/River_Flows_In_You.mp3",duration:"03:50"},{title:"Ennio Morricone",src:"./assets/sounds/Ennio_Morricone.mp3",duration:"00:58"},{title:"Summer Wind",src:"./assets/sounds/Summer_Wind.mp3",duration:"00:58"}],$=document.querySelector(".play"),C=document.querySelector(".play-prev"),b=document.querySelector(".play-next"),k=document.querySelector(".volume-icon"),x=document.querySelector(".progress__time"),I=document.querySelector(".player__volume"),M=document.querySelector(".player__bar"),A=document.querySelector(".player-track"),T=document.querySelector(".play-list");q.forEach((e=>{let t=document.createElement("li"),n=document.createElement("span");n.classList.add("play-item_icon"),t.classList.add("play-item"),t.textContent=e.title,T.append(t),t.append(n)}));const j=document.querySelectorAll(".play-item");let D=0;const N={"Aqua Caelestis":0,"River Flows In You":1,"Ennio Morricone":2,"Summer Wind":3},W=new Audio;function U(){j.forEach((e=>{e.classList.remove("active_track"),e.lastElementChild.classList.remove("pause")})),j[D].classList.add("active_track"),W.paused?j[D].lastElementChild.classList.add("pause"):j[D].lastElementChild.classList.remove("pause"),function(){let e=W.paused?"play":"pause";W[e]()}(),W.paused?$.classList.remove("pause"):$.classList.add("pause")}function F(){D=3===D?0:++D,W.src=`${q[D].src}`,A.textContent=`${q[D].title}`,W.currentTime=0,U()}function G(){const e=100*I.value;W.volume=I.value,I.style.background=`linear-gradient(to right, #000000 0%, #000000 ${e}%, #fff ${e}%, #fff 100%)`,0===W.volume?k.classList.add("mute"):k.classList.remove("mute")}let H,O;function R(e){if(!e)return"0:00";let t=Math.floor(e/60),n=Math.floor(e-60*t);return n<10&&(n=`0${n}`),`${t}:${n}`}function B(){return Math.ceil(20*Math.random())}function Y(e,t){switch(e){case"Github":X();break;case"Unsplash API":!async function(e){let t;t=e||P(new Date);const n=`https://api.unsplash.com/photos/random?query=${t}&client_id=e2077ad31a806c894c460aec8f81bc2af4d09c4f8104ae3177bb809faf0eac17`;try{const e=await fetch(n),t=await e.json(),o=new Image;o.src=`${t.urls.regular}`,o.onload=()=>{document.body.style.backgroundImage=`url(${t.urls.regular})`}}catch(e){re.value="tag not exist"}}(t);break;case"Flickr API":!async function(e){let t;t=e||P(new Date);const n=`https://www.flickr.com/services/rest/?method=flickr.photos.search&api_key=1b0d579b298ef41061e8b07aff51a8e5&tags=${t}&extras=url_l&format=json&nojsoncallback=1`;try{const e=await fetch(n),t=await e.json();let o=B();const a=new Image;a.src=`${t.photos.photo[o].url_l}`,a.onload=()=>{document.body.style.backgroundImage=`url(${t.photos.photo[o].url_l})`}}catch(e){re.value="tag not exist"}}(t)}}function P(e){const t=e.getHours();switch(Math.floor(t/6)){case 0:return"night";case 1:return"morning";case 2:return"afternoon";case 3:return"evening"}}function X(){let e,t=P(new Date);O?(O=+O,O=O>=10?O:`0${O}`):(e=B(),O=e>=10?e:`0${e}`);const n=new Image;n.src=`https://raw.githubusercontent.com/rolling-scopes-school/stage1-tasks/assets/images/${t}/${O}.jpg`,n.onload=()=>{document.body.style.backgroundImage=`url('https://raw.githubusercontent.com/rolling-scopes-school/stage1-tasks/assets/images/${t}/${O}.jpg')`}}W.src=`${q[D].src}`,A.textContent=`${q[D].title}`,$.addEventListener("click",U),C.addEventListener("click",(function(){D=0===D?3:--D,W.src=`${q[D].src}`,A.textContent=`${q[D].title}`,W.currentTime=0,U()})),b.addEventListener("click",F),G(),I.addEventListener("input",G),k.addEventListener("click",(function(){k.classList.toggle("mute"),+I.value>0?(H=I.value,I.value=0):I.value=H,G()})),W.addEventListener("timeupdate",(function(){let e=isNaN(W.duration)?0:W.currentTime/W.duration*100;M.value=isNaN(W.duration)?0:W.currentTime/W.duration,M.style.background=`linear-gradient(to right, #000000 0%, #000000 ${e}%, #fff ${e}%, #fff 100%)`,W.currentTime===W.duration&&F(),x.textContent=`${R(W.currentTime)} / ${R(W.duration)}`})),M.addEventListener("click",(function(e){let t=isNaN(W.duration)?0:e.offsetX/M.offsetWidth*W.duration;W.currentTime=t,x.textContent=`${R(W.currentTime)} / ${R(W.duration)}`})),T.addEventListener("click",(function(e){let t=D;if(e.target.classList.contains("play-item_icon")){if(e.target.classList.contains("pause"))e.target.parentElement.classList.add("active_track"),e.target.classList.remove("pause");else{e.target.parentElement.classList.add("active_track"),e.target.classList.add("pause");let n=e.target.parentElement.textContent;D=N[n],t!==D&&(W.src=`${q[D].src}`,A.textContent=`${q[D].title}`)}U()}})),X();const z=document.querySelector(".slide-prev"),J=document.querySelector(".slide-next");z.addEventListener("click",(function(){O="01"===O?20:--O,Y(Z)})),J.addEventListener("click",(function(){O=20===O?1:++O,Y(Z)}));const K=document.querySelector(".language__icons"),Q=document.querySelectorAll(".language__icon");let V="en",Z="Github";K.addEventListener("click",(e=>{Q.forEach((e=>{e.classList.remove("language__icon_active")})),e.target.classList.contains("language__icon")&&(e.target.classList.add("language__icon_active"),V=e.target.textContent),S(V),y(V),clearTimeout(c),r(V),function(e="en"){o.placeholder="ru"===e?"[Введите имя]":"[Enter name]"}(V)}));const ee=document.querySelector(".background__icons"),te=document.querySelectorAll(".bg__icon"),ne=document.querySelector(".tags__name");ee.addEventListener("click",(e=>{te.forEach((e=>{e.classList.remove("bg__icon_active")})),e.target.classList.contains("bg__icon")&&(e.target.classList.add("bg__icon_active"),Z=e.target.textContent),"Github"!==Z?ne.classList.add("tags__name_active"):ne.classList.remove("tags__name_active"),Y(Z)}));const oe=document.querySelector(".setting-icon"),ae=document.querySelector(".setting__lists");function ce(){localStorage.setItem("curBg",Z),localStorage.setItem("curLan",V)}oe.addEventListener("click",(()=>{oe.classList.toggle("setting-icon_active"),oe.classList.contains("setting-icon_active")?ae.classList.add("setting__lists_active"):ae.classList.remove("setting__lists_active")})),o.addEventListener("change",ce),window.addEventListener("DOMContentLoaded",(function(){localStorage.getItem("curBg")&&(Z=localStorage.getItem("curBg")),localStorage.getItem("curLan")&&(V=localStorage.getItem("curLan"))})),window.addEventListener("beforeunload",ce);const re=document.querySelector(".tags__name_input");re.addEventListener("change",(()=>{console.log(re.value),Y(Z,re.value)}));const se=document.querySelector(".greeting-container"),ie=document.querySelector(".quotes__container"),ue=document.querySelector(".weather"),le=document.querySelector(".player"),de=document.querySelectorAll(".checkbox_vis"),me=[e,t,se,[ie,_],ue,le];de.forEach((e=>{e.addEventListener("change",(()=>{e.checked?Array.isArray(me[e.name])?me[e.name].forEach((e=>{e.classList.remove("hidden_block")})):me[e.name].classList.remove("hidden_block"):Array.isArray(me[e.name])?me[e.name].forEach((e=>{e.classList.add("hidden_block")})):me[e.name].classList.add("hidden_block")}))}))})();